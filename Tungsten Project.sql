--Name: Anusha Nagula

--Tables:
/*1.		Customers:(CUST_ID, CUST_NAME, Email, ADDRESS, Phone, CITY, STATE, TOTAL_SPEND, MEM_STATUS)
Primary Key:CUST_ID 
FOREIGN KEY: MEM_STATUS.

2.	Products: (PROD_ID, PROD_NAME, Price, StockQuantity, SUPP_ID, DEPT_NO)
Primary Key:PROD_ID 
FOREIGN KEY: SUPP_ID, DEPT_NO.

3.	Supplier: (SUPP_ID, SNAME, ContactName, Phone, Address)
Primary Key:SUPP_ID

4.	Orders: (ORD_ID, ORDER_DATE, TOTAL_AMOUNT, CUST_ID, EMP_ID)
Primary Key:ORD_ID
FOREIGN KEY: CUST_ID, EMP_ID.

5.	Departments: (DEPT_NO, DEPT_NAME)
Primary Key:DEPT_NO

6.	Memberships: (MEM_ID, MEM_STATUS, REG_DATE, POINTSBALANCE,CUST_ID)
Primary Key:MEM_ID
FOREIGN KEY: CUST_ID.

7.	Employees: (EMP_ID, HIRE_DATE, ENAME, JOB, DEPT_NO)
Primary Key:EMP_ID
FOREIGN KEY: DEPT_NO.

8.	Inventory: (INVTY_ID, StockQuantity, last_restocked, PROD_ID)
Primary Key:INVTY_ID
FOREIGN KEY: PROD_ID.

9.	OrderDetails: (OrderDetailID, Quantity, UNIT_PRICE, ORD_ID, PROD_ID)
Primary Key:OrderDetailID
FOREIGN KEY: PROD_ID, ORD_ID.*/

---- Drop existing tables for debugging purposes
DROP TABLE ORDERDETAILS CASCADE CONSTRAINTS;
DROP TABLE ORDER_TABLE CASCADE CONSTRAINTS;
DROP TABLE INVENTORY CASCADE CONSTRAINTS;
DROP TABLE EMPLOYEES CASCADE CONSTRAINTS;
DROP TABLE DEPARTMENT CASCADE CONSTRAINTS;
DROP TABLE MEMBERSHIP CASCADE CONSTRAINTS;
DROP TABLE CUSTOMER CASCADE CONSTRAINTS;
DROP TABLE SUPPLIER CASCADE CONSTRAINTS;
DROP TABLE PRODUCT CASCADE CONSTRAINTS;

--Clean up recycle bin
PURGE RECYCLEBIN;
COMMIT;


-- Creating CUSTOMER table
CREATE TABLE CUSTOMER (
    CUST_ID VARCHAR2(10) PRIMARY KEY,
    CUST_NAME VARCHAR2(50),
    EMAIL VARCHAR2(50),
    PHONE_NO VARCHAR2(15),
    ADDRESS VARCHAR2(100),
    CITY VARCHAR2(50),
    STATE    VARCHAR2(2),
    MEM_ID VARCHAR2(10),
    TOTAL_SPENT NUMBER(8,2)
    /*I have changed the mem_status column which is present in the ERD to mem_id column*/
    /* I have removed foreign key constraint mentioned in the ERD in this step because it is not absolutely necessary
    for the project as cust_id column is present in the membership table
    and alter table is not permitted*/
);

-- Inserting data into CUSTOMER table
INSERT INTO CUSTOMER VALUES ('TGSN0001', 'JOHN DOE', 'john.doe@example.com', '720-555-0123', '123 LAWRENCE ST', 'DENVER', 'CO', 'GAME0001', 150.75);
INSERT INTO CUSTOMER VALUES ('TGSN0002', 'JANE SMITH', 'jane.smith@example.com', '720-525-0456', '456 LOGAN ST', 'LOUISVILLE', 'CO', 'GAME0002', 200);
INSERT INTO CUSTOMER VALUES ('TGSN0003', 'ALICE BROWN', 'alice.brown@example.com', '720-535-0789', '789 CHAMPA ST', 'DENVER', 'CO', 'GAME0003', 300.5);
INSERT INTO CUSTOMER VALUES ('TGSN0004', 'BOB JOHNSON', 'bob.johnson@example.com', '720-553-1011', '321 MAPLE ST', 'ARVADA', 'CO', 'GAME0004', 175.25);
INSERT INTO CUSTOMER VALUES ('TGSN0005', 'CHARLIE DAVIS', 'charlie.davis@example.com', '720-545-1213', '654 CEDAR ST', 'BROOMFIELD', 'CO', 'GAME0005', 125);
INSERT INTO CUSTOMER VALUES ('TGSN0006', 'DIANA MARTINEZ', 'diana.martinez@example.com', '720-455-1415', '987 BIRCH ST', 'AURORA', 'CO', 'GAME0006', 225.8);
INSERT INTO CUSTOMER VALUES ('TGSN0007', 'ETHAN GARCIA', 'ethan.garcia@example.com', '720-755-1617', '159 FULTON ST', 'CENTENNIAL', 'CO', 'GAME0007', 300);
INSERT INTO CUSTOMER VALUES ('TGSN0008', 'FIONA LEE', 'fiona.lee@example.com', '720-575-1819', '753 QUINCE ST', 'CASTLEWOOD', 'CO', 'GAME0008', 80);
INSERT INTO CUSTOMER VALUES ('TGSN0009', 'GEORGE WILSON', 'george.wilson@example.com', '720-585-2021', '852 SPRUCE ST', 'WILLOW CREEK', 'CO', 'GAME0009', 190);
INSERT INTO CUSTOMER VALUES ('TGSN0010', 'HANNAH ANDERSON', 'hannah.anderson@example.com', '720-855-2223', '963 CHESTNUT ST', 'LAKEWOOD', 'CO', 'GAME0010', 340.5);
INSERT INTO CUSTOMER VALUES ('TGSN0011', 'IVY THOMAS', 'ivy.thomas@example.com', '720-255-2425', '147 SYCAMORE ST', 'THORNTON', 'CO', 'GAME0011', 60);
INSERT INTO CUSTOMER VALUES ('TGSN0012', 'JACK MOORE', 'jack.moore@example.com', '720-055-2627', '258 ASH ST', 'LONE TREE', 'CO', 'GAME0012', 500);

COMMIT;


-- Creating SUPPLIER table
CREATE TABLE SUPPLIER (
    SUPP_ID NUMBER PRIMARY KEY,
    SNAME VARCHAR2(50),
    CONTACTNAME VARCHAR2(50),
    SUPP_PHONE VARCHAR2(15),
    SUPP_ADDRESS VARCHAR2(100)
);

-- Inserting data into SUPPLIER table
INSERT INTO SUPPLIER VALUES (10001, 'GAMETECH', 'MAYA CLARK', '323-525-0101', '123 GAMING ST, LOS ANGELES, CA');
INSERT INTO SUPPLIER VALUES (10002, 'PROGEAR', 'NINA BROWN', '315-125-0102', '234 GAMER AVE, NEW YORK, NY');
INSERT INTO SUPPLIER VALUES (10003, 'PIXEL PERFECT', 'TOBY HERNANDEZ', '720-345-0108', '890 PIXEL AVE DENVER CO');
INSERT INTO SUPPLIER VALUES (10004, 'GAMER''S HAVEN', 'PENNY WONG', '206-565-0104', '456 ARCADE RD SEATTLE WA');
INSERT INTO SUPPLIER VALUES (10005, 'JOYSTICK JUNCTION', 'QUIN REED', '737-578-0105', '567 CONTROL ST AUSTIN TX');

COMMIT;

-- Creating MEMBERSHIP table
CREATE TABLE MEMBERSHIP (
    MEM_ID VARCHAR2(10) PRIMARY KEY,
    CUST_ID VARCHAR2(10),
    MEM_STATUS VARCHAR2(10),
    REG_DATE DATE,
    POINTS_BALANCE NUMBER(8,2),
    CONSTRAINT fk_cust FOREIGN KEY (CUST_ID) REFERENCES CUSTOMER(CUST_ID)
);

-- Inserting data into MEMBERSHIP table
INSERT INTO MEMBERSHIP VALUES ('GAME0001', 'TGSN0001', 'ACTIVE', TO_DATE('10/4/22', 'MM/DD/YY'), 15.75);
INSERT INTO MEMBERSHIP VALUES ('GAME0002', 'TGSN0002', 'INACTIVE', TO_DATE('10/9/22', 'MM/DD/YY'), 20);
INSERT INTO MEMBERSHIP VALUES ('GAME0003', 'TGSN0003', 'ACTIVE', TO_DATE('10/14/22', 'MM/DD/YY'), 30.5);
INSERT INTO MEMBERSHIP VALUES ('GAME0004', 'TGSN0004', 'ACTIVE', TO_DATE('10/19/22', 'MM/DD/YY'), 17.25);
INSERT INTO MEMBERSHIP VALUES ('GAME0005', 'TGSN0005', 'INACTIVE', TO_DATE('10/24/22', 'MM/DD/YY'), 12);
INSERT INTO MEMBERSHIP VALUES ('GAME0006', 'TGSN0006', 'ACTIVE', TO_DATE('10/29/22', 'MM/DD/YY'), 22.8);
INSERT INTO MEMBERSHIP VALUES ('GAME0007', 'TGSN0007', 'ACTIVE', TO_DATE('11/3/22', 'MM/DD/YY'), 30);
INSERT INTO MEMBERSHIP VALUES ('GAME0008', 'TGSN0008', 'INACTIVE', TO_DATE('11/8/22', 'MM/DD/YY'), 8);
INSERT INTO MEMBERSHIP VALUES ('GAME0009', 'TGSN0009', 'ACTIVE', TO_DATE('11/13/22', 'MM/DD/YY'), 19);
INSERT INTO MEMBERSHIP VALUES ('GAME0010', 'TGSN0010', 'ACTIVE', TO_DATE('11/18/22', 'MM/DD/YY'), 34.5);
INSERT INTO MEMBERSHIP VALUES ('GAME0011', 'TGSN0011', 'INACTIVE', TO_DATE('11/23/22', 'MM/DD/YY'), 6);
INSERT INTO MEMBERSHIP VALUES ('GAME0012', 'TGSN0012', 'ACTIVE', TO_DATE('11/28/22', 'MM/DD/YY'), 50);

COMMIT;

-- Creating DEPARTMENT table
CREATE TABLE DEPARTMENT (
    DEPTNO NUMBER PRIMARY KEY,
    DEPT_NAME VARCHAR2(50)
);

-- Inserting data into DEPARTMENT table
INSERT INTO DEPARTMENT VALUES (201, 'FINANCE');
INSERT INTO DEPARTMENT VALUES (202, 'OPERATIONS');
INSERT INTO DEPARTMENT VALUES (203, 'ELECTRONICS');
INSERT INTO DEPARTMENT VALUES (204, 'CDs/DVDs');
INSERT INTO DEPARTMENT VALUES (205, 'ACCESSORIES');

COMMIT;

-- Creating EMPLOYEES table
CREATE TABLE EMPLOYEES (
    EMP_ID NUMBER PRIMARY KEY,
    ENAME VARCHAR2(50),
    JOB VARCHAR2(50),
    DEPT_NO NUMBER,
    HIRE_DATE DATE,
    CONSTRAINT fk_dept FOREIGN KEY (DEPT_NO) REFERENCES DEPARTMENT(DEPTNO)
);

-- Inserting data into EMPLOYEES table
INSERT INTO EMPLOYEES VALUES (7839, 'KING', 'PRESIDENT', 201, TO_DATE('02-Apr-11', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7698, 'BLAKE', 'MANAGER', 201, TO_DATE('01-May-12', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7782, 'CLARK', 'CASHIER', 202, TO_DATE('09-Jun-13', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7566, 'JONES', 'SALESMAN', 203, TO_DATE('17-Nov-11', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7499, 'ALLEN', 'MANAGER', 203, TO_DATE('20-Feb-13', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7844, 'TURNER', 'CASHIER', 202, TO_DATE('08-Sep-14', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7900, 'JAMES', 'SALESMAN', 204, TO_DATE('03-Dec-15', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7902, 'FORD', 'MANAGER', 204, TO_DATE('03-Dec-16', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7369, 'SMITH', 'CASHIER', 202, TO_DATE('17-Dec-15', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7788, 'SCOTT', 'SALESMAN', 205, TO_DATE('17-Dec-15', 'DD-Mon-YY'));
INSERT INTO EMPLOYEES VALUES (7934, 'MILLER', 'MANAGER', 205, TO_DATE('23-Jan-16', 'DD-Mon-YY'));

COMMIT;

-- Creating PRODUCT table
CREATE TABLE PRODUCT (
    PROD_ID VARCHAR2(10) PRIMARY KEY,
    PROD_NAME VARCHAR2(50),
    PRICE NUMBER(8,2),
    DEPTNO NUMBER,
    STOCK_QTY NUMBER(8,2),
    SUPP_ID NUMBER,
    CONSTRAINT fk_supp FOREIGN KEY (SUPP_ID) REFERENCES SUPPLIER(SUPP_ID),
    CONSTRAINT fk_prod_dept FOREIGN KEY (DEPTNO) REFERENCES DEPARTMENT(DEPTNO)
);

-- Inserting data into PRODUCT table
INSERT INTO PRODUCT VALUES (100860, 'GAMING HEADSET T', 10, 203, 20, 10002);
INSERT INTO PRODUCT VALUES (100861, 'WIRELESS JOYSTICK U', 5, 203, 9, 10005);
INSERT INTO PRODUCT VALUES (100870, 'WIRELESS MOUSE Q', 6.5, 203, 11, 10002);
INSERT INTO PRODUCT VALUES (100871, 'EXTERNAL SSD Y', 18, 203, 4, 10005);
INSERT INTO PRODUCT VALUES (100890, 'RGB KEYBOARD BB', 14, 203, 6, 10002);
INSERT INTO PRODUCT VALUES (101860, 'GAMING CHAIR I', 30, 205, 4, 10004);
INSERT INTO PRODUCT VALUES (101863, 'GAMING CHAIR II', 40, 205, 3, 10004);
INSERT INTO PRODUCT VALUES (102130, 'NFS CD', 5, 204, 10, 10001);
INSERT INTO PRODUCT VALUES (200376, 'PUBG CD', 9, 204, 20, 10003);
INSERT INTO PRODUCT VALUES (200380, 'RACING CD', 7.5, 204, 25, 10001);

COMMIT;

-- Creating INVENTORY table
CREATE TABLE INVENTORY (
    INV_ID VARCHAR2(10) PRIMARY KEY,
    PROD_ID VARCHAR2(10),
    STOCK_QTY NUMBER(5),
    LAST_RESTOCKED DATE,
    CONSTRAINT fk_prod FOREIGN KEY (PROD_ID) REFERENCES PRODUCT(PROD_ID)
);

-- Inserting data into INVENTORY table
INSERT INTO INVENTORY VALUES ('INVTY5001', 100860, 20, TO_DATE('15-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5002', 100861, 9, TO_DATE('20-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5003', 100870, 11, TO_DATE('30-Aug-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5004', 100871, 4, TO_DATE('05-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5005', 100890, 6, TO_DATE('12-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5006', 101860, 4, TO_DATE('25-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5007', 101863, 3, TO_DATE('28-Aug-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5008', 102130, 10, TO_DATE('10-Jul-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5009', 200376, 20, TO_DATE('18-Sep-24', 'DD-Mon-YY'));
INSERT INTO INVENTORY VALUES ('INVTY5010', 200380, 25, TO_DATE('10-Sep-24', 'DD-Mon-YY'));

COMMIT;

-- Creating ORDER table
CREATE TABLE ORDER_TABLE (
    ORDER_ID VARCHAR2(10) PRIMARY KEY,
    CUST_ID VARCHAR2(10),
    ORDER_DATE DATE,
    TOTAL_AMOUNT NUMBER(8,2),
    EMP_ID NUMBER,
    CONSTRAINT fk_cust_order FOREIGN KEY (CUST_ID) REFERENCES CUSTOMER(CUST_ID),
    CONSTRAINT fk_emp_order FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEES(EMP_ID)
);

-- Inserting data into ORDER table
INSERT INTO ORDER_TABLE VALUES (500001, 'TGSN0001', TO_DATE('01-Sep-24', 'DD-Mon-YY'), 120.75, 7566);
INSERT INTO ORDER_TABLE VALUES (500002, 'TGSN0002', TO_DATE('05-Sep-24', 'DD-Mon-YY'), 180, 7900);
INSERT INTO ORDER_TABLE VALUES (500003, 'TGSN0003', TO_DATE('10-Sep-24', 'DD-Mon-YY'), 250.5, 7788);
INSERT INTO ORDER_TABLE VALUES (500004, 'TGSN0004', TO_DATE('12-Sep-24', 'DD-Mon-YY'), 160.25, 7566);
INSERT INTO ORDER_TABLE VALUES (500005, 'TGSN0005', TO_DATE('12-Sep-24', 'DD-Mon-YY'), 100, 7900);
INSERT INTO ORDER_TABLE VALUES (500006, 'TGSN0006', TO_DATE('18-Sep-24', 'DD-Mon-YY'), 200.8, 7788);
INSERT INTO ORDER_TABLE VALUES (500007, 'TGSN0007', TO_DATE('20-Sep-24', 'DD-Mon-YY'), 280, 7566);
INSERT INTO ORDER_TABLE VALUES (500008, 'TGSN0008', TO_DATE('22-Sep-24', 'DD-Mon-YY'), 70, 7900);
INSERT INTO ORDER_TABLE VALUES (500009, 'TGSN0009', TO_DATE('25-Sep-24', 'DD-Mon-YY'), 170, 7788);
INSERT INTO ORDER_TABLE VALUES (500010, 'TGSN0010', TO_DATE('25-Sep-24', 'DD-Mon-YY'), 320.5, 7566);
INSERT INTO ORDER_TABLE VALUES (500011, 'TGSN0011', TO_DATE('29-Sep-24', 'DD-Mon-YY'), 50, 7900);
INSERT INTO ORDER_TABLE VALUES (500012, 'TGSN0012', TO_DATE('01-Oct-24', 'DD-Mon-YY'), 450, 7788);
INSERT INTO ORDER_TABLE VALUES (500013, 'TGSN0001', TO_DATE('03-Oct-24', 'DD-Mon-YY'), 100, 7566);
INSERT INTO ORDER_TABLE VALUES (500014, 'TGSN0003', TO_DATE('04-Oct-24', 'DD-Mon-YY'), 200, 7900);
INSERT INTO ORDER_TABLE VALUES (500015, 'TGSN0005', TO_DATE('05-Oct-24', 'DD-Mon-YY'), 90, 7788);

COMMIT;

-- Creating ORDERDETAILS table
CREATE TABLE ORDERDETAILS (
    DETAIL_ID VARCHAR2(10) PRIMARY KEY,
    ORDER_ID VARCHAR2(10),
    PROD_ID VARCHAR2(10),
    QUANTITY NUMBER(5),
    UNIT_PRICE NUMBER(8,2),
    CONSTRAINT fk_order FOREIGN KEY (ORDER_ID) REFERENCES ORDER_TABLE(ORDER_ID),
    CONSTRAINT fk_prod_detail FOREIGN KEY (PROD_ID) REFERENCES PRODUCT(PROD_ID)
);

-- Inserting data into ORDER_DETAILS table
INSERT INTO ORDERDETAILS VALUES (10001, 500001, 100860, 2, 10);
INSERT INTO ORDERDETAILS VALUES (10002, 500001, 100870, 1, 6.5);
INSERT INTO ORDERDETAILS VALUES (10003, 500002, 100890, 3, 14);
INSERT INTO ORDERDETAILS VALUES (10004, 500002, 200376, 1, 9);
INSERT INTO ORDERDETAILS VALUES (10005, 500003, 101860, 1, 30);
INSERT INTO ORDERDETAILS VALUES (10006, 500003, 102130, 2, 5);
INSERT INTO ORDERDETAILS VALUES (10007, 500004, 101863, 1, 40);
INSERT INTO ORDERDETAILS VALUES (10008, 500004, 200380, 2, 7.5);
INSERT INTO ORDERDETAILS VALUES (10009, 500005, 100861, 1, 5);
INSERT INTO ORDERDETAILS VALUES (10010, 500006, 100871, 2, 18);
INSERT INTO ORDERDETAILS VALUES (10011, 500006, 200376, 1, 9);
INSERT INTO ORDERDETAILS VALUES (10012, 500007, 200380, 1, 7.5);
INSERT INTO ORDERDETAILS VALUES (10013, 500008, 100890, 2, 14);
INSERT INTO ORDERDETAILS VALUES (10014, 500008, 101860, 1, 30);
INSERT INTO ORDERDETAILS VALUES (10015, 500009, 100860, 1, 10);
INSERT INTO ORDERDETAILS VALUES (10016, 500009, 102130, 2, 5);
INSERT INTO ORDERDETAILS VALUES (10017, 500010, 100861, 2, 5);
INSERT INTO ORDERDETAILS VALUES (10018, 500010, 100871, 1, 18);
INSERT INTO ORDERDETAILS VALUES (10019, 500011, 100890, 1, 14);
INSERT INTO ORDERDETAILS VALUES (10020, 500012, 200376, 3, 9);
INSERT INTO ORDERDETAILS VALUES (10021, 500012, 101863, 1, 40);
INSERT INTO ORDERDETAILS VALUES (10022, 500013, 200380, 2, 7.5);
INSERT INTO ORDERDETAILS VALUES (10023, 500014, 101860, 1, 30);
INSERT INTO ORDERDETAILS VALUES (10024, 500015, 100871, 2, 18);
INSERT INTO ORDERDETAILS VALUES (10025, 500015, 200376, 1, 9);

COMMIT;

--STEP:2 
--Query01 INNER JOIN: Retrieve customer names along with the total amount of their orders.
SELECT C.CUST_NAME, O.TOTAL_AMOUNT
FROM CUSTOMER C
INNER JOIN ORDER_TABLE O ON C.CUST_ID = O.CUST_ID
ORDER BY C.CUST_NAME;

--Query02 INNER JOIN: Retrieve names of customers who have active membership
SELECT C.CUST_ID, C.CUST_NAME,M.MEM_ID
FROM CUSTOMER C
INNER JOIN MEMBERSHIP M ON C.CUST_ID = M.CUST_ID
WHERE MEM_STATUS='ACTIVE'

--Query03 OUTER JOIN: Find the products and their departments including the departments that do not have product
SELECT D.DEPTNO,D.DEPT_NAME,P.PROD_ID,P.PROD_NAME
FROM DEPARTMENT D
LEFT OUTER JOIN PRODUCT P ON P.DEPTNO=D.DEPTNO
ORDER BY D.DEPTNO;

--Query04 SELF JOIN: Find employees who have the same job as another employee.
SELECT DISTINCT E1.ENAME AS EMPLOYEE, E2.ENAME AS OTHER_EMPLOYEE,  E1.JOB
FROM EMPLOYEES E1
JOIN EMPLOYEES E2 ON E1.JOB = E2.JOB
WHERE E1.EMP_ID < E2.EMP_ID
ORDER BY E1.JOB;


--Query05 SET OPERATIONS: Find all employees who are not managers.
SELECT ENAME,JOB    
FROM EMPLOYEES
MINUS
SELECT ENAME,JOB
FROM EMPLOYEES
WHERE JOB = 'MANAGER';

--Query06 AGGREGATE: Get the total amount of orders per customer where the total is greater than 100, grouped by customer.
SELECT C.CUST_NAME, SUM(O.TOTAL_AMOUNT) AS TOTAL_SPENT
FROM CUSTOMER C
INNER JOIN ORDER_TABLE O ON C.CUST_ID = O.CUST_ID
GROUP BY C.CUST_NAME
HAVING SUM(O.TOTAL_AMOUNT) > 100;

--Query07 AGGREGATE: Find the number of products supplied by each supplier and filter those with more than 1 products.
SELECT S.SNAME, COUNT(P.PROD_ID) AS PRODUCT_COUNT
FROM SUPPLIER S
INNER JOIN PRODUCT P ON S.SUPP_ID = P.SUPP_ID
GROUP BY S.SNAME
HAVING COUNT(P.PROD_ID) > 1;

--Query08 SUBQUERY: Find the products that have greater price than average price of all products
SELECT PROD_NAME, PRICE
FROM PRODUCT
WHERE PRICE > (SELECT AVG(PRICE) FROM PRODUCT);

--Query09 SUBQUERY: Find orders that exceed the average order value of their respective customers.
SELECT ORDER_ID, CUST_ID
FROM ORDER_TABLE O
WHERE TOTAL_AMOUNT > (SELECT AVG(TOTAL_AMOUNT) FROM ORDER_TABLE WHERE CUST_ID = O.CUST_ID);

--Query10 COMPLEX QUERY: List the products that are quantity more than 3 and less than 8 from 'ELECTRONICS' OR 'ACCESSORIES'
SELECT P.PROD_ID,P.PROD_NAME,P.STOCK_QTY,D.DEPT_NAME
FROM PRODUCT P
JOIN DEPARTMENT D ON P.DEPTNO = D.DEPTNO
WHERE (P.STOCK_QTY>3 AND P.STOCK_QTY<8)
AND (D.DEPT_NAME ='ELECTRONICS' OR  D.DEPT_NAME='ACCESSORIES');

-- Additional Queries:
--Query11 SELF JOIN: Find the list of orders that are placed on same date.
SELECT A.ORDER_ID AS ORDER_ID1,B.ORDER_ID AS ORDER_ID2,A.ORDER_DATE
FROM ORDER_TABLE A 
INNER JOIN ORDER_TABLE B ON A.ORDER_DATE=B.ORDER_DATE
WHERE A.ORDER_ID<B.ORDER_ID;

--Query12 AGGREGATES: Find the list of customers who placed orders more than 1.
SELECT C.CUST_NAME,C.CUST_ID, COUNT(O.ORDER_ID) AS NO_OF_ORDER
FROM CUSTOMER C
JOIN ORDER_TABLE O ON C.CUST_ID = O.CUST_ID
GROUP BY C.CUST_NAME,C.CUST_ID
HAVING COUNT(O.ORDER_ID) > 1;

--Query13 SUBQUERY: Find the suppliers that provide products that are more expensive than cheapest product in the store
SELECT DISTINCT S.SNAME
FROM SUPPLIER S
JOIN PRODUCT P ON S.SUPP_ID = P.SUPP_ID
WHERE P.PRICE > (SELECT MIN(PRICE) FROM PRODUCT);

--Query14 SET OPERATIONS:Retrieve a list of all unique product names from both the `ELECTRONICS` and `ACCESSORIES` departments.
SELECT P.PROD_NAME,D.DEPT_NAME
FROM PRODUCT P
JOIN DEPARTMENT D ON P.DEPTNO = D.DEPTNO
WHERE D.DEPT_NAME = 'ELECTRONICS'

UNION

SELECT P.PROD_NAME,D.DEPT_NAME
FROM PRODUCT P
JOIN DEPARTMENT D ON P.DEPTNO = D.DEPTNO
WHERE D.DEPT_NAME = 'ACCESSORIES';

--Query15 OUTER JOIN: List the customers and orders placed by them along with the total amount. 
SELECT C.CUST_ID, C.CUST_NAME, O.ORDER_ID, O.TOTAL_AMOUNT
FROM CUSTOMER C
FULL OUTER JOIN ORDER_TABLE O ON C.CUST_ID = O.CUST_ID
ORDER BY C.CUST_ID;

